library(kernlab)
#specc() function does spectral clustering
#
A<-matrix(rep(1,9),3,3)
A<-rbind(cbind(A,0*A),cbind(0*A,A))
rno<-matrix(rnorm(36),6,6)*.25
rno<-t(rno)%*%rno
A2<-A+rno
#image(A)
print(eigen(A))
p<-locator()
plot(eigen(A)$values)
p<-locator()
#
image(A2)
print(eigen(A2))
p<-locator()
plot(eigen(A2)$values)
p<-locator()
#
cv<-as.matrix(dist(iris[,-5]))
image(cv)
p<-locator()
plot(eigen(exp(-1*cv/.5))$values)
p<-locator()
plot(eigen(exp(-1*cv/1))$values)
p<-locator()
par(mfrow=c(2,2))
plot(eigen(exp(-1*cv/1))$vectors[,1])
plot(eigen(exp(-1*cv/1))$vectors[,2])
plot(eigen(exp(-1*cv/1))$vectors[,3])
plot(eigen(exp(-1*cv/1))$vectors[,4])
p<-locator()
kk2<-kmeans(eigen(exp(-1*cv/1))$vec[,1:3],3)
print(table(iris[,5],kk2$cluster))
p<-locator()
#
data(spirals)
par(mfrow=c(1,1))
plot(spirals)
p<-locator()
ed<-eigen(exp(-1*as.matrix(dist(spirals)))/.5)
plot(ed$val)
p<-locator()
kk1<-kmeans(spirals,2)
plot(spirals,col=kk1$cluster,main="k-means on data")
p<-locator()
kk2<-specc(spirals,centers=2)
plot(spirals,col=kk2,main="k-means on eigen vectors")
p<-locator()
#
#
par(mfrow=c(1,1))
plot(donuts[,1:2],col=donuts[,3])
p<-locator()
ed<-eigen(exp(-1*as.matrix(dist(donuts)))/.5)
plot(ed$val)
p<-locator()
#
kk1<-kmeans(donuts[,1:2],2)
plot(donuts[,1:2],col=kk1$cluster,main="k-means on data")
p<-locator()
par(mfrow=c(2,2))
plot(ed$vec[,1])
plot(ed$vec[,2])
plot(ed$vec[,3])
plot(ed$vec[,4])
par(mfrow=c(1,1))
p<-locator()
kk2<-kmeans(ed$vec[,1],2)
plot(donuts[,1:2],col=kk2$cluster,main="k-means on eigen vectors")
p<-locator()
hc<-hclust(dist(donuts[,1:2]),"single")
plot(hc,labels=donuts[,3])
p<-locator()
hc<-hclust(dist(donuts[,1:2]),"complete")
plot(hc,labels=donuts[,3])


